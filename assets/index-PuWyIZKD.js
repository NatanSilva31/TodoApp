const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-DTdCLqIf.js","assets/vendor-B-2yl_ca.js","assets/vendor-DpTtVfbh.css","assets/settings-D1zrOcJj.js","assets/ui-lib-C41lPcrf.js","assets/tasks-mHMF68ea.js","assets/emoji-D7qZVVSC.js","assets/ntc-LB1IgDFN.js","assets/TaskDetails-CPiEaaJ9.js","assets/NotFound-CMQ-9myt.js","assets/Share-1eihK8VS.js","assets/AddTask-Dj6Op-WM.js","assets/InputThemeProvider-CklFHxRk.js","assets/UserProfile-DMsXavJ6.js","assets/Transfer-DURpBhcD.js","assets/Categories-CEYG-qOX.js","assets/Purge-dxCSsT9x.js"])))=>i.map(i=>d[i]);
var F=Object.defineProperty;var M=(t,n,a)=>n in t?F(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a;var E=(t,n,a)=>M(t,typeof n!="symbol"?n+"":n,a);import{R as O,j as e,X as N,r as u,Y as $,Z as x,V as b,$ as q,a0 as G}from"./vendor-B-2yl_ca.js";import{a3 as J,bm as H,l as k,bn as K,aK as Y,a7 as W,bo as X,aL as Z,bp as U,B as T,bq as Q,x as ee,z as te,E as re,n as y,b as se,W as oe,u as ae,br as ne,bs as ie,ac as P,bt as le,C as ce}from"./ui-lib-C41lPcrf.js";import{a as de}from"./emoji-D7qZVVSC.js";import{u as pe}from"./tasks-mHMF68ea.js";import{U as D,h as v,k as ue,S as me,e as he,b as fe,D as w,g as S,P as xe,B as ge,u as ye,C as _,L as je,y as ve,z as A,A as C,E as Ee,F as L,G as Ce}from"./settings-D1zrOcJj.js";import{l as _e,a as be}from"./ntc-LB1IgDFN.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function d(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();class V extends O.Component{constructor(a){super(a);E(this,"handleOpenDialog",()=>{this.setState({openClearDialog:!0})});E(this,"handleCloseDialog",()=>{this.setState({openClearDialog:!1})});E(this,"handleConfirmClearData",()=>{localStorage.clear(),sessionStorage.clear(),location.reload()});this.state={hasError:!1,openClearDialog:!1}}static getDerivedStateFromError(a){return{hasError:!0,error:a,openClearDialog:!1}}componentDidCatch(a,d){if(console.error("Error:",a),console.error("Error Info:",d),a.message.includes("Failed to fetch dynamically imported")||a.message.includes("is not a valid JavaScript")){v("Reloading page",{type:"loading"});const o=parseInt(sessionStorage.getItem("reload_retries")||"0",10);o<3&&setTimeout(()=>{sessionStorage.setItem("reload_retries",String(o+1)),location.reload()},1e3)}}render(){var a,d,o,r,i;if(this.state.hasError){const{user:s}=this.context,{tasks:p}=s;return e.jsxs(Te,{children:[e.jsxs(ke,{children:[e.jsx("span",{children:"Oops! An error occurred. "}),e.jsx("span",{children:e.jsx(de,{size:38,unified:"1f644"})})]}),e.jsx(Se,{children:e.jsx(ue,{scale:.6,variant:"error"})}),e.jsxs("h2",{children:["To fix it, try clearing your local files (cookies and cache) and then refresh the page. If the problem persists, please report the issue via"," ",e.jsx(me,{translate:"no",href:"https://github.com/natansilva31/TodoApp/issues",children:"Github Issues"}),"."]}),e.jsx(J,{severity:"error",variant:"filled",sx:{mt:"-8px",mb:"18px"},children:"By cleaning app data, you will lose all of your tasks."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs(I,{color:"warning",onClick:()=>location.reload(),children:[e.jsx(H,{}),"   Refresh Page"]}),e.jsxs(I,{color:"error",onClick:this.handleOpenDialog,children:[e.jsx(k,{}),"   Auto Clear"]})]}),e.jsxs("h3",{children:[e.jsxs("span",{style:{color:"#ff3131",display:"inline-block"},children:[e.jsx(K,{sx:{verticalAlign:"middle",mb:"4px"}})," ERROR:"]})," ",e.jsxs("span",{translate:"no",children:["[",(a=this.state.error)==null?void 0:a.name,"] ",(d=this.state.error)==null?void 0:d.message]})]}),e.jsxs(Ae,{disableGutters:!0,children:[e.jsx(Y,{expandIcon:e.jsx(De,{}),children:e.jsxs(W,{fontWeight:700,fontSize:18,sx:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(X,{})," Error stack"]})}),e.jsx(Z,{children:e.jsx("div",{translate:"no",style:{opacity:.8,fontSize:"12px"},children:(i=(o=this.state.error)==null?void 0:o.stack)==null?void 0:i.replace((r=this.state.error)==null?void 0:r.message,"")})})]}),e.jsxs("pre",{children:[e.jsxs(we,{children:[e.jsx(U,{}),"   User Data"]}),e.jsxs(T,{variant:"outlined",sx:{ml:"6px",my:"18px",p:"12px 20px",borderRadius:"14px"},onClick:()=>{he(p),v(`Exported all tasks (${p.length})`)},children:[e.jsx(Q,{}),"   Export Tasks To JSON"]}),e.jsx("br",{}),e.jsx("code",{translate:"no",children:JSON.stringify(s,null,4)})]}),e.jsxs(ee,{open:this.state.openClearDialog,onClose:this.handleCloseDialog,children:[e.jsx(fe,{title:"Clear Data",subTitle:"This action cannot be undone.",icon:e.jsx(k,{}),onClose:this.handleCloseDialog}),e.jsx(te,{children:"Are you sure you want to clear all data? You will loose all of your tasks."}),e.jsxs(re,{children:[e.jsx(w,{onClick:this.handleCloseDialog,children:"Cancel"}),e.jsx(w,{onClick:this.handleConfirmClearData,color:"error",children:"Confirm"})]})]})]})}return this.props.children}}E(V,"contextType",D);const Te=y.div`
  margin: 0 8vw;
  @media (max-width: 768px) {
    margin: 0;
  }
`,Se=y.div`
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 8px;
`,ke=y.h1`
  margin-top: 32px;
  margin-bottom: 32px;
  font-size: 36px;
  color: #ff3131;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  @media (max-width: 768px) {
    text-align: left;
    justify-content: left;
    font-size: 30px;
    margin-top: 0;
    margin-bottom: 0;
  }
`,Ae=y(se)`
  color: ${({theme:t})=>S(t.secondary)};
  border-radius: 14px !important;
  background: ${({theme:t})=>S(t.secondary)}18;
  box-shadow: none;
  padding: 4px;
  margin-bottom: 18px;
`,De=y(oe)`
  color: ${({theme:t})=>S(t.secondary)};
  font-size: 32px;
`,Pe=({...t})=>e.jsx(T,{variant:"outlined",size:"large",...t}),I=y(Pe)`
  padding: 10px 30px;
  border-radius: 12px;
  @media (max-width: 768px) {
    width: 100%;
  }
`,we=y.p`
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 8px 0;
`,Le=({children:t})=>e.jsxs(e.Fragment,{children:[e.jsx(xe,{}),t,e.jsx("div",{style:{marginTop:"128px"}}),e.jsx(ge,{})]}),Ie=()=>{const t=ye(),n=ae();return e.jsx(N,{position:"top-center",reverseOrder:!1,gutter:12,containerStyle:{marginBottom:t?"96px":"12px"},toastOptions:{position:"bottom-center",duration:4e3,style:{padding:"14px 22px",borderRadius:"18px",fontSize:"17px",border:`2px solid ${n.primary}`,background:n.darkmode?"#141431e0":"#ffffffe0",color:n.darkmode?_.fontLight:_.fontDark,WebkitBackdropFilter:"blur(6px)",backdropFilter:"blur(6px)"},success:{iconTheme:{primary:n.primary,secondary:S(n.primary)}},error:{iconTheme:{primary:_.red,secondary:"white"},style:{borderColor:_.red}}}})},Re="modulepreload",Be=function(t){return"/TodoApp/"+t},R={},h=function(n,a,d){let o=Promise.resolve();if(a&&a.length>0){let i=function(l){return Promise.all(l.map(m=>Promise.resolve(m).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),p=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));o=i(a.map(l=>{if(l=Be(l),l in R)return;R[l]=!0;const m=l.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const c=document.createElement("link");if(c.rel=m?"stylesheet":Re,m||(c.as="script"),c.crossOrigin="",c.href=l,p&&c.setAttribute("nonce",p),document.head.appendChild(c),m)return new Promise((j,g)=>{c.addEventListener("load",j),c.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(i){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i}return o.then(i=>{for(const s of i||[])s.status==="rejected"&&r(s.reason);return n().catch(r)})},ze=u.lazy(()=>h(()=>import("./Home-DTdCLqIf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Oe=u.lazy(()=>h(()=>import("./TaskDetails-CPiEaaJ9.js"),__vite__mapDeps([8,1,2,5,6,4,3,7,9]))),We=u.lazy(()=>h(()=>import("./Share-1eihK8VS.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,0]))),Ue=u.lazy(()=>h(()=>import("./AddTask-Dj6Op-WM.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,12]))),Ve=u.lazy(()=>h(()=>import("./UserProfile-DMsXavJ6.js"),__vite__mapDeps([13,1,2,4,3,5,6,7]))),Fe=u.lazy(()=>h(()=>import("./Transfer-DURpBhcD.js"),__vite__mapDeps([14,1,2,5,6,4,3,7]))),Me=u.lazy(()=>h(()=>import("./Categories-CEYG-qOX.js"),__vite__mapDeps([15,1,2,6,5,4,3,7,12]))),Ne=u.lazy(()=>h(()=>import("./Purge-dxCSsT9x.js"),__vite__mapDeps([16,1,2,5,6,4,3,7]))),$e=u.lazy(()=>h(()=>import("./NotFound-CMQ-9myt.js"),__vite__mapDeps([9,1,2,4,3,5,6,7]))),qe=()=>e.jsx(u.Suspense,{fallback:e.jsx(je,{}),children:e.jsxs($,{children:[e.jsx(x,{path:"/",element:e.jsx(ze,{})}),e.jsx(x,{path:"/task/:id",element:e.jsx(Oe,{})}),e.jsx(x,{path:"/share",element:e.jsx(We,{})}),e.jsx(x,{path:"/add",element:e.jsx(Ue,{})}),e.jsx(x,{path:"/user",element:e.jsx(Ve,{})}),e.jsx(x,{path:"/transfer",element:e.jsx(Fe,{})}),e.jsx(x,{path:"/categories",element:e.jsx(Me,{})}),e.jsx(x,{path:"/purge",element:e.jsx(Ne,{})}),e.jsx(x,{path:"*",element:e.jsx($e,{})})]})});function Ge(){const{user:t,setUser:n}=u.useContext(D),a=ve(),d=u.useCallback((r,i)=>r?(Object.keys(i).forEach(s=>{if(s==="categories"||s==="colorList"&&t.colorList&&!A.colorList.every((m,f)=>m===t.colorList[f]))return;s==="settings"&&Array.isArray(r.settings)&&(delete r.settings,v("Removed old settings array format.",{duration:6e3,icon:e.jsx(k,{}),disableVibrate:!0}));const p=r[s],l=i[s];typeof l=="object"&&l!==null?r[s]=d(p,l):p===void 0&&(r[s]=l,v(e.jsxs("div",{children:["Added new property to user object"," ",e.jsxs("i",{translate:"no",children:[s.toString(),": ",r[s].toString()]})]}),{duration:6e3,icon:e.jsx(U,{}),disableVibrate:!0}))}),r):i,[t.colorList]);u.useEffect(()=>{n(r=>{const i=d({...r},A);return r!==i?i:r})},[n,t.colorList,d]),u.useEffect(()=>{const r=async p=>{if("setAppBadge"in navigator)try{await navigator.setAppBadge(p)}catch(l){console.error("Failed to set app badge:",l)}},i=async()=>{if("clearAppBadge"in navigator)try{await navigator.clearAppBadge()}catch(p){console.error("Failed to clear app badge:",p)}},s=async()=>{if(t.settings.appBadge){if(await Notification.requestPermission()==="granted"){const p=t.tasks.filter(l=>!l.done).length;isNaN(p)||r(p)}}else i()};"setAppBadge"in navigator&&s()},[t.settings.appBadge,t.tasks]);const o=u.useCallback(()=>{if(a==="unknown")return C[0].MuiTheme;if(t.theme==="system")return a==="dark"?C[0].MuiTheme:C[1].MuiTheme;const r=C.find(i=>i.name===t.theme);return r?r.MuiTheme:C[0].MuiTheme},[a,t.theme]);return u.useEffect(()=>{const r=document.querySelector("meta[name=theme-color]");r&&r.setAttribute("content",o().palette.secondary.main)},[t.theme,o]),e.jsx(ne,{theme:Ee(o().palette.primary.main,o().palette.secondary.main,L(t.darkmode,a,o().palette.secondary.main)?"dark":"light"),children:e.jsxs(ie,{theme:{primary:o().palette.primary.main,secondary:o().palette.secondary.main,darkmode:L(t.darkmode,a,o().palette.secondary.main),mui:o()},children:[e.jsx(Ce,{}),e.jsx(Ie,{}),e.jsx(V,{children:e.jsx(Le,{children:e.jsx(qe,{})})})]})})}const Je=({children:t})=>{const[n,a]=pe(A,"user");return e.jsx(D.Provider,{value:{user:n,setUser:a},children:t})};function He(t={}){const{immediate:n=!1,onNeedRefresh:a,onOfflineReady:d,onRegistered:o,onRegisteredSW:r,onRegisterError:i}=t;let s,p,l;const m=async(c=!0)=>{await p,l==null||l()};async function f(){if("serviceWorker"in navigator){if(s=await h(async()=>{const{Workbox:c}=await import("./vendor-B-2yl_ca.js").then(j=>j.a2);return{Workbox:c}},__vite__mapDeps([1,2])).then(({Workbox:c})=>new c("/TodoApp/sw.js",{scope:"/TodoApp/",type:"classic"})).catch(c=>{i==null||i(c)}),!s)return;l=()=>{s==null||s.messageSkipWaiting()};{let c=!1;const j=()=>{c=!0,s==null||s.addEventListener("controlling",g=>{g.isUpdate&&window.location.reload()}),a==null||a()};s.addEventListener("installed",g=>{typeof g.isUpdate>"u"?typeof g.isExternal<"u"&&g.isExternal?j():!c&&(d==null||d()):g.isUpdate||d==null||d()}),s.addEventListener("waiting",j)}s.register({immediate:n}).then(c=>{r?r("/TodoApp/sw.js",c):o==null||o(c)}).catch(c=>{i==null||i(c)})}}return p=f(),m}const Ke=t=>{t.addEventListener("updatefound",()=>{const n=t.installing;n&&n.addEventListener("statechange",()=>{n.state==="installed"&&navigator.serviceWorker.controller&&b(a=>e.jsxs(P,{spacing:2,children:[e.jsx(W,{variant:"subtitle1",fontWeight:700,children:"A new version of the app is available. Reload to update?"}),e.jsxs(P,{direction:"row",spacing:1,children:[e.jsx(T,{fullWidth:!0,variant:"contained",onClick:()=>{n.postMessage({type:"SKIP_WAITING"}),b.dismiss(a.id)},startIcon:e.jsx(le,{}),children:"Reload"}),e.jsx(T,{fullWidth:!0,variant:"outlined",onClick:()=>b.dismiss(a.id),children:"Dismiss"})]})]}),{duration:1/0,style:{border:"none"}})})})};_e(be);const B=parseInt(localStorage.getItem("offlinePreparationCount")||"0",10);B<3&&!localStorage.getItem("initialCachingComplete")&&(v("Preparing app for offline use...",{duration:1/0,type:"blank",id:"initial-offline-preparation",icon:e.jsx(ce,{size:20,thickness:4})}),localStorage.setItem("offlinePreparationCount",(B+1).toString()));He({onRegistered(t){t&&Ke(t)},onOfflineReady(){b.dismiss("initial-offline-preparation"),localStorage.getItem("initialCachingComplete")||(v("App is ready to work offline.",{type:"success"}),localStorage.setItem("initialCachingComplete","true"))}});var z;(z=navigator.serviceWorker)==null||z.addEventListener("controllerchange",()=>{window.location.reload()});q.createRoot(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(Je,{children:e.jsx(G,{children:e.jsx(Ge,{})})})}));export{h as _};
