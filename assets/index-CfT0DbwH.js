const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-vx3t8vv-.js","assets/vendor-B-2yl_ca.js","assets/vendor-DpTtVfbh.css","assets/settings-xmdSeWFy.js","assets/ui-lib-C41lPcrf.js","assets/tasks-DYYyw5nR.js","assets/emoji-D7qZVVSC.js","assets/ntc-LB1IgDFN.js","assets/TaskDetails-Dw0Ozawn.js","assets/NotFound-RrA5VO8V.js","assets/Share-DRzORxw_.js","assets/AddTask-7CCD6o0E.js","assets/InputThemeProvider-GGltdu8Q.js","assets/UserProfile-DaAbOjw3.js","assets/Transfer-BgGf_b8S.js","assets/Categories-CCb_WI7k.js","assets/Purge-DvDYUOF4.js"])))=>i.map(i=>d[i]);
var F=Object.defineProperty;var N=(t,i,s)=>i in t?F(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;var E=(t,i,s)=>N(t,typeof i!="symbol"?i+"":i,s);import{R as W,j as e,X as M,r as p,b as $,u as q,Y as G,Z as g,V as _,$ as H,a0 as J}from"./vendor-B-2yl_ca.js";import{a3 as K,bm as Y,l as w,bn as X,aK as Z,a7 as O,bo as Q,aL as ee,bp as U,B as b,bq as te,x as se,z as re,E as oe,n as y,b as ae,W as ne,u as ie,br as le,bs as ce,ac as A,bt as de,C as pe}from"./ui-lib-C41lPcrf.js";import{a as ue}from"./emoji-D7qZVVSC.js";import{u as he}from"./tasks-DYYyw5nR.js";import{U as D,h as v,k as me,S as fe,e as ge,b as xe,D as P,g as T,P as ye,B as je,u as ve,C as S,L as Ee,y as Ce,z as Se,A as k,E as C,F as _e,G as L,H as be}from"./settings-xmdSeWFy.js";import{l as Te,a as we}from"./ntc-LB1IgDFN.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();class V extends W.Component{constructor(s){super(s);E(this,"handleOpenDialog",()=>{this.setState({openClearDialog:!0})});E(this,"handleCloseDialog",()=>{this.setState({openClearDialog:!1})});E(this,"handleConfirmClearData",()=>{localStorage.clear(),sessionStorage.clear(),location.reload()});this.state={hasError:!1,openClearDialog:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s,openClearDialog:!1}}componentDidCatch(s,l){if(console.error("Error:",s),console.error("Error Info:",l),s.message.includes("Failed to fetch dynamically imported")||s.message.includes("is not a valid JavaScript")){v("Reloading page",{type:"loading"});const a=parseInt(sessionStorage.getItem("reload_retries")||"0",10);a<3&&setTimeout(()=>{sessionStorage.setItem("reload_retries",String(a+1)),location.reload()},1e3)}}render(){var s,l,a,r,n;if(this.state.hasError){const{user:o}=this.context,{tasks:u}=o;return e.jsxs(ke,{children:[e.jsxs(Ae,{children:[e.jsx("span",{children:"Oops! An error occurred. "}),e.jsx("span",{children:e.jsx(ue,{size:38,unified:"1f644"})})]}),e.jsx(De,{children:e.jsx(me,{scale:.6,variant:"error"})}),e.jsxs("h2",{children:["To fix it, try clearing your local files (cookies and cache) and then refresh the page. If the problem persists, please report the issue via"," ",e.jsx(fe,{translate:"no",href:"https://github.com/natansilva31/TodoApp/issues",children:"Github Issues"}),"."]}),e.jsx(K,{severity:"error",variant:"filled",sx:{mt:"-8px",mb:"18px"},children:"By cleaning app data, you will lose all of your tasks."}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs(I,{color:"warning",onClick:()=>location.reload(),children:[e.jsx(Y,{}),"   Refresh Page"]}),e.jsxs(I,{color:"error",onClick:this.handleOpenDialog,children:[e.jsx(w,{}),"   Auto Clear"]})]}),e.jsxs("h3",{children:[e.jsxs("span",{style:{color:"#ff3131",display:"inline-block"},children:[e.jsx(X,{sx:{verticalAlign:"middle",mb:"4px"}})," ERROR:"]})," ",e.jsxs("span",{translate:"no",children:["[",(s=this.state.error)==null?void 0:s.name,"] ",(l=this.state.error)==null?void 0:l.message]})]}),e.jsxs(Pe,{disableGutters:!0,children:[e.jsx(Z,{expandIcon:e.jsx(Le,{}),children:e.jsxs(O,{fontWeight:700,fontSize:18,sx:{display:"flex",alignItems:"center",gap:"6px"},children:[e.jsx(Q,{})," Error stack"]})}),e.jsx(ee,{children:e.jsx("div",{translate:"no",style:{opacity:.8,fontSize:"12px"},children:(n=(a=this.state.error)==null?void 0:a.stack)==null?void 0:n.replace((r=this.state.error)==null?void 0:r.message,"")})})]}),e.jsxs("pre",{children:[e.jsxs(Re,{children:[e.jsx(U,{}),"   User Data"]}),e.jsxs(b,{variant:"outlined",sx:{ml:"6px",my:"18px",p:"12px 20px",borderRadius:"14px"},onClick:()=>{ge(u),v(`Exported all tasks (${u.length})`)},children:[e.jsx(te,{}),"   Export Tasks To JSON"]}),e.jsx("br",{}),e.jsx("code",{translate:"no",children:JSON.stringify(o,null,4)})]}),e.jsxs(se,{open:this.state.openClearDialog,onClose:this.handleCloseDialog,children:[e.jsx(xe,{title:"Clear Data",subTitle:"This action cannot be undone.",icon:e.jsx(w,{}),onClose:this.handleCloseDialog}),e.jsx(re,{children:"Are you sure you want to clear all data? You will loose all of your tasks."}),e.jsxs(oe,{children:[e.jsx(P,{onClick:this.handleCloseDialog,children:"Cancel"}),e.jsx(P,{onClick:this.handleConfirmClearData,color:"error",children:"Confirm"})]})]})]})}return this.props.children}}E(V,"contextType",D);const ke=y.div`
  margin: 0 8vw;
  @media (max-width: 768px) {
    margin: 0;
  }
`,De=y.div`
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 8px;
`,Ae=y.h1`
  margin-top: 32px;
  margin-bottom: 32px;
  font-size: 36px;
  color: #ff3131;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  @media (max-width: 768px) {
    text-align: left;
    justify-content: left;
    font-size: 30px;
    margin-top: 0;
    margin-bottom: 0;
  }
`,Pe=y(ae)`
  color: ${({theme:t})=>T(t.secondary)};
  border-radius: 14px !important;
  background: ${({theme:t})=>T(t.secondary)}18;
  box-shadow: none;
  padding: 4px;
  margin-bottom: 18px;
`,Le=y(ne)`
  color: ${({theme:t})=>T(t.secondary)};
  font-size: 32px;
`,Ie=({...t})=>e.jsx(b,{variant:"outlined",size:"large",...t}),I=y(Ie)`
  padding: 10px 30px;
  border-radius: 12px;
  @media (max-width: 768px) {
    width: 100%;
  }
`,Re=y.p`
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 8px 0;
`,Be=({children:t})=>e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),t,e.jsx("div",{style:{marginTop:"128px"}}),e.jsx(je,{})]}),ze=()=>{const t=ve(),i=ie();return e.jsx(M,{position:"top-center",reverseOrder:!1,gutter:12,containerStyle:{marginBottom:t?"96px":"12px"},toastOptions:{position:"bottom-center",duration:4e3,style:{padding:"14px 22px",borderRadius:"18px",fontSize:"17px",border:`2px solid ${i.primary}`,background:i.darkmode?"#141431e0":"#ffffffe0",color:i.darkmode?S.fontLight:S.fontDark,WebkitBackdropFilter:"blur(6px)",backdropFilter:"blur(6px)"},success:{iconTheme:{primary:i.primary,secondary:T(i.primary)}},error:{iconTheme:{primary:S.red,secondary:"white"},style:{borderColor:S.red}}}})},We="modulepreload",Oe=function(t){return"/TodoApp/"+t},R={},m=function(i,s,l){let a=Promise.resolve();if(s&&s.length>0){let n=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=n(s.map(c=>{if(c=Oe(c),c in R)return;R[c]=!0;const h=c.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":We,h||(d.as="script"),d.crossOrigin="",d.href=c,u&&d.setAttribute("nonce",u),document.head.appendChild(d),h)return new Promise((j,x)=>{d.addEventListener("load",j),d.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(n){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=n,window.dispatchEvent(o),!o.defaultPrevented)throw n}return a.then(n=>{for(const o of n||[])o.status==="rejected"&&r(o.reason);return i().catch(r)})},Ue=p.lazy(()=>m(()=>import("./Home-vx3t8vv-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Ve=p.lazy(()=>m(()=>import("./TaskDetails-Dw0Ozawn.js"),__vite__mapDeps([8,1,2,5,6,4,3,7,9]))),Fe=p.lazy(()=>m(()=>import("./Share-DRzORxw_.js"),__vite__mapDeps([10,1,2,3,4,5,6,7,0]))),Ne=p.lazy(()=>m(()=>import("./AddTask-7CCD6o0E.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,12]))),Me=p.lazy(()=>m(()=>import("./UserProfile-DaAbOjw3.js"),__vite__mapDeps([13,1,2,4,3,5,6,7]))),$e=p.lazy(()=>m(()=>import("./Transfer-BgGf_b8S.js"),__vite__mapDeps([14,1,2,5,6,4,3,7]))),qe=p.lazy(()=>m(()=>import("./Categories-CCb_WI7k.js"),__vite__mapDeps([15,1,2,6,5,4,3,7,12]))),Ge=p.lazy(()=>m(()=>import("./Purge-DvDYUOF4.js"),__vite__mapDeps([16,1,2,5,6,4,3,7]))),He=p.lazy(()=>m(()=>import("./NotFound-RrA5VO8V.js"),__vite__mapDeps([9,1,2,4,3,5,6,7]))),Je=()=>{const[t,i]=p.useState(!1),s=p.useRef(""),l=$(),a=q();p.useEffect(()=>{window.location.hash.startsWith("#settings/")&&(s.current||(s.current=l.pathname+l.search),i(!0))},[]),p.useEffect(()=>{const n=()=>{window.location.hash.startsWith("#settings/")?(s.current||(s.current=l.pathname+l.search),i(!0)):i(!1)};return window.addEventListener("hashchange",n),()=>window.removeEventListener("hashchange",n)},[l.pathname]);const r=()=>{i(!1),setTimeout(()=>{const n=s.current||"/";s.current="",l.pathname!==n&&a(n,{replace:!0}),history.replaceState(null,"",n)},0)};return e.jsxs(e.Fragment,{children:[e.jsx(p.Suspense,{fallback:e.jsx(Ee,{}),children:e.jsxs(G,{children:[e.jsx(g,{path:"/",element:e.jsx(Ue,{})}),e.jsx(g,{path:"/task/:id",element:e.jsx(Ve,{})}),e.jsx(g,{path:"/share",element:e.jsx(Fe,{})}),e.jsx(g,{path:"/add",element:e.jsx(Ne,{})}),e.jsx(g,{path:"/user",element:e.jsx(Me,{})}),e.jsx(g,{path:"/transfer",element:e.jsx($e,{})}),e.jsx(g,{path:"/categories",element:e.jsx(qe,{})}),e.jsx(g,{path:"/purge",element:e.jsx(Ge,{})}),!t&&e.jsx(g,{path:"*",element:e.jsx(He,{})})]})}),e.jsx(Ce,{open:t,onClose:r})]})};function Ke(){const{user:t,setUser:i}=p.useContext(D),s=Se(),l=p.useCallback((r,n)=>r?(Object.keys(n).forEach(o=>{if(o==="categories"||o==="colorList"&&t.colorList&&!k.colorList.every((h,f)=>h===t.colorList[f]))return;o==="settings"&&Array.isArray(r.settings)&&(delete r.settings,v("Removed old settings array format.",{duration:6e3,icon:e.jsx(w,{}),disableVibrate:!0}));const u=r[o],c=n[o];typeof c=="object"&&c!==null?r[o]=l(u,c):u===void 0&&(r[o]=c,v(e.jsxs("div",{children:["Added new property to user object"," ",e.jsxs("i",{translate:"no",children:[o.toString(),": ",r[o].toString()]})]}),{duration:6e3,icon:e.jsx(U,{}),disableVibrate:!0}))}),r):n,[t.colorList]);p.useEffect(()=>{i(r=>{const n=l({...r},k);return r!==n?n:r})},[i,t.colorList,l]),p.useEffect(()=>{const r=async u=>{if("setAppBadge"in navigator)try{await navigator.setAppBadge(u)}catch(c){console.error("Failed to set app badge:",c)}},n=async()=>{if("clearAppBadge"in navigator)try{await navigator.clearAppBadge()}catch(u){console.error("Failed to clear app badge:",u)}},o=async()=>{if(t.settings.appBadge){if(await Notification.requestPermission()==="granted"){const u=t.tasks.filter(c=>!c.done).length;isNaN(u)||r(u)}}else n()};"setAppBadge"in navigator&&o()},[t.settings.appBadge,t.tasks]);const a=p.useCallback(()=>{if(s==="unknown")return C[0].MuiTheme;if(t.theme==="system")return s==="dark"?C[0].MuiTheme:C[1].MuiTheme;const r=C.find(n=>n.name===t.theme);return r?r.MuiTheme:C[0].MuiTheme},[s,t.theme]);return p.useEffect(()=>{const r=document.querySelector("meta[name=theme-color]");r&&r.setAttribute("content",a().palette.secondary.main)},[t.theme,a]),e.jsx(le,{theme:_e(a().palette.primary.main,a().palette.secondary.main,L(t.darkmode,s,a().palette.secondary.main)?"dark":"light"),children:e.jsxs(ce,{theme:{primary:a().palette.primary.main,secondary:a().palette.secondary.main,darkmode:L(t.darkmode,s,a().palette.secondary.main),mui:a()},children:[e.jsx(be,{}),e.jsx(ze,{}),e.jsx(V,{children:e.jsx(Be,{children:e.jsx(Je,{})})})]})})}const Ye=({children:t})=>{const[i,s]=he(k,"user");return e.jsx(D.Provider,{value:{user:i,setUser:s},children:t})};function Xe(t={}){const{immediate:i=!1,onNeedRefresh:s,onOfflineReady:l,onRegistered:a,onRegisteredSW:r,onRegisterError:n}=t;let o,u,c;const h=async(d=!0)=>{await u,c==null||c()};async function f(){if("serviceWorker"in navigator){if(o=await m(async()=>{const{Workbox:d}=await import("./vendor-B-2yl_ca.js").then(j=>j.a2);return{Workbox:d}},__vite__mapDeps([1,2])).then(({Workbox:d})=>new d("/TodoApp/sw.js",{scope:"/TodoApp/",type:"classic"})).catch(d=>{n==null||n(d)}),!o)return;c=()=>{o==null||o.messageSkipWaiting()};{let d=!1;const j=()=>{d=!0,o==null||o.addEventListener("controlling",x=>{x.isUpdate&&window.location.reload()}),s==null||s()};o.addEventListener("installed",x=>{typeof x.isUpdate>"u"?typeof x.isExternal<"u"&&x.isExternal?j():!d&&(l==null||l()):x.isUpdate||l==null||l()}),o.addEventListener("waiting",j)}o.register({immediate:i}).then(d=>{r?r("/TodoApp/sw.js",d):a==null||a(d)}).catch(d=>{n==null||n(d)})}}return u=f(),h}const Ze=t=>{t.addEventListener("updatefound",()=>{const i=t.installing;i&&i.addEventListener("statechange",()=>{i.state==="installed"&&navigator.serviceWorker.controller&&_(s=>e.jsxs(A,{spacing:2,children:[e.jsx(O,{variant:"subtitle1",fontWeight:700,children:"A new version of the app is available. Reload to update?"}),e.jsxs(A,{direction:"row",spacing:1,children:[e.jsx(b,{fullWidth:!0,variant:"contained",onClick:()=>{i.postMessage({type:"SKIP_WAITING"}),_.dismiss(s.id)},startIcon:e.jsx(de,{}),children:"Reload"}),e.jsx(b,{fullWidth:!0,variant:"outlined",onClick:()=>_.dismiss(s.id),children:"Dismiss"})]})]}),{duration:1/0,style:{border:"none"}})})})};Te(we);const B=parseInt(localStorage.getItem("offlinePreparationCount")||"0",10);B<3&&!localStorage.getItem("initialCachingComplete")&&(v("Preparando o aplicativo para uso offline...",{duration:1/0,type:"blank",id:"initial-offline-preparation",icon:e.jsx(pe,{size:20,thickness:4})}),localStorage.setItem("offlinePreparationCount",(B+1).toString()));Xe({onRegistered(t){t&&Ze(t)},onOfflineReady(){_.dismiss("initial-offline-preparation"),localStorage.getItem("initialCachingComplete")||(v("App is ready to work offline.",{type:"success"}),localStorage.setItem("initialCachingComplete","true"))}});var z;(z=navigator.serviceWorker)==null||z.addEventListener("controllerchange",()=>{window.location.reload()});H.createRoot(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(Ye,{children:e.jsx(J,{children:e.jsx(Ke,{})})})}));export{m as _};
