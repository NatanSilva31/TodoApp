const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotFound-BdUj29m6.js","assets/vendor-B-2yl_ca.js","assets/vendor-DpTtVfbh.css","assets/ui-lib-C41lPcrf.js","assets/settings-B7nXNRV0.js","assets/tasks-Dg1Jr4qq.js","assets/emoji-D7qZVVSC.js","assets/ntc-LB1IgDFN.js"])))=>i.map(i=>d[i]);
import{_ as le}from"./index-BAchXecl.js";import{r as n,u as de,j as e}from"./vendor-B-2yl_ca.js";import{a as ce}from"./emoji-D7qZVVSC.js";import{u as $}from"./tasks-Dg1Jr4qq.js";import{U as ge,C as k,aa as c,J as me,aj as he,ak as xe,al as ue,am as je,an as R,ao as Ce,ap as pe,aq as fe,p as V,ar as Ee,t as H,g as ye,as as ke,b as J,m as ve,at as Te,D as v,au as be,h as T,j as De}from"./settings-B7nXNRV0.js";import{C as Se}from"./InputThemeProvider-C79cN9ME.js";import{u as Ae,f as Ne,g as B,a0 as K,bc as we,x as X,ah as Y,z as Q,aK as _e,W as Pe,aL as Oe,E as Z,be as $e}from"./ui-lib-C41lPcrf.js";import"./ntc-LB1IgDFN.js";const Re=n.lazy(()=>le(()=>import("./NotFound-BdUj29m6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),Ge=()=>{var U;const{user:o,setUser:p}=n.useContext(ge),u=Ae(),[d,I]=$("","catName","sessionStorage"),[b,D]=n.useState(""),[j,L]=$(null,"catEmoji","sessionStorage"),[S,F]=$(u.primary,"catColor","sessionStorage"),[ee,C]=n.useState(!1),[i,A]=n.useState(),[te,N]=n.useState(!1),[g,w]=n.useState(""),[f,_]=n.useState(""),[M,W]=n.useState(null),[E,P]=n.useState(k.purple),z=de();n.useEffect(()=>{document.title="Todo App - Categorias",o.settings.enableCategories||z("/"),d.length>c&&D(`O nome é muito longo (máximo ${c} caracteres)`)},[z,d.length,o.settings]),n.useEffect(()=>{var t,a;P(((t=o.categories.find(s=>s.id===i))==null?void 0:t.color)||k.purple),w(((a=o.categories.find(s=>s.id===i))==null?void 0:a.name)||""),_("")},[i,o.categories]);const q=t=>{var a;if(t){const s=((a=o.categories.find(r=>r.id===t))==null?void 0:a.name)||"",l=o.categories.filter(r=>r.id!==t),m=o.favoriteCategories.filter(r=>r!==t),h=o.tasks.map(r=>{var y;const x=(y=r.category)==null?void 0:y.filter(ne=>ne.id!==t);return{...r,category:x}});p({...o,categories:l,favoriteCategories:m,tasks:h}),T(e.jsxs("div",{children:["Categoria excluída - ",e.jsxs("b",{translate:"no",children:[s,"."]})]}))}},ae=t=>{const a=t.target.value;I(a),a.length>c?D(`O nome é muito longo (máximo ${c} caracteres)`):D("")},oe=t=>{const a=t.target.value;w(a),a.length>c?_(`O nome é muito longo (máximo ${c} caracteres)`):_("")},se=()=>{if(d!==""){if(d.length>c)return;const t={id:De(),name:d,emoji:j!==""&&j!==null?j:void 0,color:S};T(e.jsxs("div",{children:["Categoria adicionada - ",e.jsx("b",{translate:"no",children:t.name})]})),p(a=>({...a,categories:[...a.categories,t]})),I(""),F(u.primary),L("")}else T("O nome da categoria é obrigatório.",{type:"error"})},O=()=>{A(void 0),N(!1),P(u.primary),w(""),W(null)},ie=()=>{if(i){const t=o.categories.map(s=>s.id===i?{...s,name:g,emoji:M||void 0,color:E}:s),a=o.tasks.map(s=>{var m;const l=(m=s.category)==null?void 0:m.map(h=>h.id===i?{id:i,name:g,emoji:M||void 0,color:E}:h);return{...s,category:l}});p({...o,categories:t,tasks:a}),T(e.jsxs("div",{children:["Categoria atualizada - ",e.jsx("b",{translate:"no",children:g})]})),N(!1)}},re=t=>{p(a=>({...a,favoriteCategories:a.favoriteCategories.includes(t.id)?a.favoriteCategories.filter(s=>s!==t.id):[...a.favoriteCategories,t.id]}))},G=t=>o.tasks.filter(a=>{var s;return(s=a.category)==null?void 0:s.some(l=>l.id===t)});return o.settings.enableCategories?e.jsxs(e.Fragment,{children:[e.jsx(me,{title:"Categorias"}),e.jsxs(he,{children:[o.categories.length>0?e.jsx(xe,{children:o.categories.map(t=>{const a=o.tasks.filter(r=>{var x;return(x=r.category)==null?void 0:x.some(y=>y.id===t.id)}),s=a.reduce((r,x)=>x.done?r+1:r,0),l=a.length,m=l>0?Math.floor(s/l*100):0,h=l>0?`(${m}%)`:"";return e.jsxs(ue,{clr:t.color,children:[e.jsxs(je,{translate:"no",children:[e.jsx("span",{children:t.emoji&&e.jsx(ce,{unified:t.emoji,emojiStyle:o.emojisStyle})})," ",e.jsx("span",{style:{wordBreak:"break-all",fontWeight:600},children:t.name}),l>0&&e.jsx(Ne,{title:"Porcentagem de conclusão das tarefas atribuídas a esta categoria",children:e.jsx("span",{style:{opacity:.8,fontStyle:"italic"},children:h})})]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[e.jsx(R,{children:e.jsx(B,{color:"warning",onClick:()=>re(t),children:o.favoriteCategories.includes(t.id)?e.jsx(Ce,{color:"warning"}):e.jsx(pe,{color:"disabled"})})}),e.jsx(R,{children:e.jsx(B,{color:"primary",onClick:()=>{A(t.id),N(!0)},children:e.jsx(K,{})})}),e.jsx(R,{children:e.jsx(B,{color:"error",onClick:()=>{A(t.id),l>0||o.favoriteCategories.includes(t.id)?C(!0):q(t.id)},children:e.jsx(we,{})})})]})]},t.id)})}):e.jsx("p",{children:"Você não tem nenhuma categoria"}),e.jsxs(fe,{children:[e.jsx("h2",{children:"Adicionar nova categoria"}),e.jsx(V,{emoji:typeof j=="string"?j:void 0,setEmoji:L,color:S,name:d,type:"category"}),e.jsx(Se,{children:e.jsx(Ee,{required:!0,label:"Nome da categoria",placeholder:"Digite o nome da categoria",value:d,onChange:ae,error:b!=="",helperText:d==""?void 0:b||`${d.length}/${c}`})}),e.jsx(H,{color:S,onColorChange:t=>{F(t)},width:400,fontColor:ye(u.secondary)}),e.jsx(ke,{onClick:se,disabled:d.length>c,children:"Criar Categoria"})]}),e.jsxs(X,{open:ee,onClose:()=>C(!1),children:[e.jsx(J,{title:"Excluir esta categoria?",subTitle:"Esta ação não pode ser desfeita.",icon:e.jsx(Y,{}),onClose:()=>C(!1)}),e.jsxs(Q,{children:[i&&e.jsx(ve,{glow:!1,category:o.categories.find(t=>t.id===i),sx:{width:"100%",height:"100%",margin:"0 auto",borderRadius:"12px"}}),G(i).length>0&&e.jsxs(Te,{children:[e.jsx(_e,{expandIcon:e.jsx(Pe,{}),children:e.jsx("span",{style:{fontWeight:600},children:`Associated Tasks (${G(i).length})`})}),e.jsx(Oe,{sx:{p:0,m:0},children:e.jsx("ul",{children:o.tasks.filter(t=>{var a;return(a=t.category)==null?void 0:a.some(s=>s.id===i)}).map(t=>e.jsx("li",{children:t.name},t.id))})})]})]}),e.jsxs(Z,{children:[e.jsx(v,{onClick:()=>C(!1),children:"Cancelar"}),e.jsxs(v,{onClick:()=>{q(i),C(!1)},color:"error",children:[e.jsx(Y,{}),"   Excluir"]})]})]}),e.jsxs(X,{open:te,onClose:O,slotProps:{paper:{style:{borderRadius:"24px",padding:"12px",minWidth:"350px"}}},children:[e.jsx(J,{title:"Editar categoria",subTitle:"Edite os detalhes da categoria.",icon:e.jsx(K,{}),onClose:O}),e.jsxs(Q,{children:[e.jsx(V,{emoji:((U=o.categories.find(t=>t.id===i))==null?void 0:U.emoji)||void 0,setEmoji:W,color:E,name:g,type:"category"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx(be,{label:"Insira o nome da categoria",placeholder:"Insira o nome da categoria",value:g,error:f!==""||g.length===0,onChange:oe,helperText:f||(g.length===0?"O nome da categoria é obrigatório":`${g.length}/${c}`)}),e.jsx(H,{color:E,width:"350px",fontColor:u.darkmode?k.fontLight:k.fontDark,onColorChange:t=>{P(t)}})]})]}),e.jsxs(Z,{children:[e.jsx(v,{onClick:O,children:"Cancelar"}),e.jsxs(v,{onClick:ie,disabled:f!==""||g.length===0,children:[e.jsx($e,{}),"   Salvar"]})]})]})]})]}):e.jsx(Re,{message:"As categorias não estão habilitadas."})};export{Ge as default};
