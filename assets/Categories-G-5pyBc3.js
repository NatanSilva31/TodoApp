const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/NotFound-BeNfe-bH.js","assets/vendor-CAPrwHoW.js","assets/vendor-DpTtVfbh.css","assets/ui-lib-lpr_KMSR.js","assets/settings-BshogTHf.js","assets/tasks-u5ZNZD5t.js","assets/emoji-DdLBlTIZ.js","assets/ntc-LB1IgDFN.js"])))=>i.map(i=>d[i]);
import{_ as le}from"./index-AZYLRJdZ.js";import{r as n,u as de,j as e}from"./vendor-CAPrwHoW.js";import{a as ce}from"./emoji-DdLBlTIZ.js";import{u as R}from"./tasks-u5ZNZD5t.js";import{U as ge,C as k,a9 as c,I as me,ai as he,aj as xe,ak as je,al as ue,am as B,an as Ce,ao as pe,ap as fe,p as Y,aq as ye,t as H,g as Ee,ar as ke,b as K,m as ve,as as Te,D as v,at as De,h as T,j as Se}from"./settings-BshogTHf.js";import{C as Ne}from"./InputThemeProvider-DrStsf2h.js";import{u as be,f as Ae,g as I,a0 as V,bc as we,x as X,ah as J,z as Q,aK as _e,W as Pe,aL as $e,E as Z,be as Re}from"./ui-lib-lpr_KMSR.js";import"./ntc-LB1IgDFN.js";const Be=n.lazy(()=>le(()=>import("./NotFound-BeNfe-bH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ze=()=>{var G;const{user:o,setUser:p}=n.useContext(ge),j=be(),[d,L]=R("","catName","sessionStorage"),[D,S]=n.useState(""),[u,F]=R(null,"catEmoji","sessionStorage"),[N,q]=R(j.primary,"catColor","sessionStorage"),[ee,C]=n.useState(!1),[i,b]=n.useState(),[te,A]=n.useState(!1),[g,w]=n.useState(""),[f,_]=n.useState(""),[M,O]=n.useState(null),[y,P]=n.useState(k.purple),W=de();n.useEffect(()=>{document.title="Todo App - Categories",o.settings.enableCategories||W("/"),d.length>c&&S(`Name is too long (maximum ${c} characters)`)},[W,d.length,o.settings]),n.useEffect(()=>{var t,s;P(((t=o.categories.find(a=>a.id===i))==null?void 0:t.color)||k.purple),w(((s=o.categories.find(a=>a.id===i))==null?void 0:s.name)||""),_("")},[i,o.categories]);const U=t=>{var s;if(t){const a=((s=o.categories.find(r=>r.id===t))==null?void 0:s.name)||"",l=o.categories.filter(r=>r.id!==t),m=o.favoriteCategories.filter(r=>r!==t),h=o.tasks.map(r=>{var E;const x=(E=r.category)==null?void 0:E.filter(ne=>ne.id!==t);return{...r,category:x}});p({...o,categories:l,favoriteCategories:m,tasks:h}),T(e.jsxs("div",{children:["Deleted category - ",e.jsxs("b",{translate:"no",children:[a,"."]})]}))}},se=t=>{const s=t.target.value;L(s),s.length>c?S(`Name is too long (maximum ${c} characters)`):S("")},oe=t=>{const s=t.target.value;w(s),s.length>c?_(`Name is too long (maximum ${c} characters)`):_("")},ae=()=>{if(d!==""){if(d.length>c)return;const t={id:Se(),name:d,emoji:u!==""&&u!==null?u:void 0,color:N};T(e.jsxs("div",{children:["Added category - ",e.jsx("b",{translate:"no",children:t.name})]})),p(s=>({...s,categories:[...s.categories,t]})),L(""),q(j.primary),F("")}else T("Category name is required.",{type:"error"})},$=()=>{b(void 0),A(!1),P(j.primary),w(""),O(null)},ie=()=>{if(i){const t=o.categories.map(a=>a.id===i?{...a,name:g,emoji:M||void 0,color:y}:a),s=o.tasks.map(a=>{var m;const l=(m=a.category)==null?void 0:m.map(h=>h.id===i?{id:i,name:g,emoji:M||void 0,color:y}:h);return{...a,category:l}});p({...o,categories:t,tasks:s}),T(e.jsxs("div",{children:["Updated category - ",e.jsx("b",{translate:"no",children:g})]})),A(!1)}},re=t=>{p(s=>({...s,favoriteCategories:s.favoriteCategories.includes(t.id)?s.favoriteCategories.filter(a=>a!==t.id):[...s.favoriteCategories,t.id]}))},z=t=>o.tasks.filter(s=>{var a;return(a=s.category)==null?void 0:a.some(l=>l.id===t)});return o.settings.enableCategories?e.jsxs(e.Fragment,{children:[e.jsx(me,{title:"Categories"}),e.jsxs(he,{children:[o.categories.length>0?e.jsx(xe,{children:o.categories.map(t=>{const s=o.tasks.filter(r=>{var x;return(x=r.category)==null?void 0:x.some(E=>E.id===t.id)}),a=s.reduce((r,x)=>x.done?r+1:r,0),l=s.length,m=l>0?Math.floor(a/l*100):0,h=l>0?`(${m}%)`:"";return e.jsxs(je,{clr:t.color,children:[e.jsxs(ue,{translate:"no",children:[e.jsx("span",{children:t.emoji&&e.jsx(ce,{unified:t.emoji,emojiStyle:o.emojisStyle})})," ",e.jsx("span",{style:{wordBreak:"break-all",fontWeight:600},children:t.name}),l>0&&e.jsx(Ae,{title:"The percentage of completion of tasks assigned to this category",children:e.jsx("span",{style:{opacity:.8,fontStyle:"italic"},children:h})})]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[e.jsx(B,{children:e.jsx(I,{color:"warning",onClick:()=>re(t),children:o.favoriteCategories.includes(t.id)?e.jsx(Ce,{color:"warning"}):e.jsx(pe,{color:"disabled"})})}),e.jsx(B,{children:e.jsx(I,{color:"primary",onClick:()=>{b(t.id),A(!0)},children:e.jsx(V,{})})}),e.jsx(B,{children:e.jsx(I,{color:"error",onClick:()=>{b(t.id),l>0||o.favoriteCategories.includes(t.id)?C(!0):U(t.id)},children:e.jsx(we,{})})})]})]},t.id)})}):e.jsx("p",{children:"You don't have any categories"}),e.jsxs(fe,{children:[e.jsx("h2",{children:"Add New Category"}),e.jsx(Y,{emoji:typeof u=="string"?u:void 0,setEmoji:F,color:N,name:d,type:"category"}),e.jsx(Ne,{children:e.jsx(ye,{required:!0,label:"Category name",placeholder:"Enter category name",value:d,onChange:se,error:D!=="",helperText:d==""?void 0:D||`${d.length}/${c}`})}),e.jsx(H,{color:N,onColorChange:t=>{q(t)},width:400,fontColor:Ee(j.secondary)}),e.jsx(ke,{onClick:ae,disabled:d.length>c,children:"Create Category"})]}),e.jsxs(X,{open:ee,onClose:()=>C(!1),children:[e.jsx(K,{title:"Delete this category?",subTitle:"This action cannot be undone.",icon:e.jsx(J,{}),onClose:()=>C(!1)}),e.jsxs(Q,{children:[i&&e.jsx(ve,{glow:!1,category:o.categories.find(t=>t.id===i),sx:{width:"100%",height:"100%",margin:"0 auto",borderRadius:"12px"}}),z(i).length>0&&e.jsxs(Te,{children:[e.jsx(_e,{expandIcon:e.jsx(Pe,{}),children:e.jsx("span",{style:{fontWeight:600},children:`Associated Tasks (${z(i).length})`})}),e.jsx($e,{sx:{p:0,m:0},children:e.jsx("ul",{children:o.tasks.filter(t=>{var s;return(s=t.category)==null?void 0:s.some(a=>a.id===i)}).map(t=>e.jsx("li",{children:t.name},t.id))})})]})]}),e.jsxs(Z,{children:[e.jsx(v,{onClick:()=>C(!1),children:"Cancel"}),e.jsxs(v,{onClick:()=>{U(i),C(!1)},color:"error",children:[e.jsx(J,{}),"   Delete"]})]})]}),e.jsxs(X,{open:te,onClose:$,slotProps:{paper:{style:{borderRadius:"24px",padding:"12px",minWidth:"350px"}}},children:[e.jsx(K,{title:"Edit Category",subTitle:"Edit the details of the category.",icon:e.jsx(V,{}),onClose:$}),e.jsxs(Q,{children:[e.jsx(Y,{emoji:((G=o.categories.find(t=>t.id===i))==null?void 0:G.emoji)||void 0,setEmoji:O,color:y,name:g,type:"category"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx(De,{label:"Enter category name",placeholder:"Enter category name",value:g,error:f!==""||g.length===0,onChange:oe,helperText:f||(g.length===0?"Category name is required":`${g.length}/${c}`)}),e.jsx(H,{color:y,width:"350px",fontColor:j.darkmode?k.fontLight:k.fontDark,onColorChange:t=>{P(t)}})]})]}),e.jsxs(Z,{children:[e.jsx(v,{onClick:$,children:"Cancel"}),e.jsxs(v,{onClick:ie,disabled:f!==""||g.length===0,children:[e.jsx(Re,{}),"   Save"]})]})]})]})]}):e.jsx(Be,{message:"Categories are not enabled."})};export{ze as default};
